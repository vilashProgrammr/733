{"version":3,"file":"xml-reader.js","sourceRoot":"","sources":["../../../../projects/xliffmerge/src/xliffmerge/xml-reader.ts"],"names":[],"mappings":";;AAAA,mDAA6C;AAC7C;;;GAGG;AAEH,MAAa,SAAS;IAGlB;;;;;;OAMG;IACI,MAAM,CAAC,kBAAkB,CAAC,IAAY,EAAE,QAAiB;QAC5D,IAAI,CAAC,QAAQ,EAAE;YACX,QAAQ,GAAG,SAAS,CAAC,gBAAgB,CAAC;SACzC;QACD,IAAI,OAAO,GAAW,oBAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QACpD,MAAM,aAAa,GAAG,SAAS,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QACzD,IAAI,aAAa,KAAK,QAAQ,EAAE;YAC5B,uCAAuC;YACvC,OAAO,GAAG,oBAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;SAChD;QACD,OAAO;YACH,OAAO,EAAE,OAAO;YAChB,QAAQ,EAAE,aAAa;SAC1B,CAAC;IACN,CAAC;IAED;;;;;OAKG;IACK,MAAM,CAAC,eAAe,CAAC,SAAiB;QAC5C,MAAM,KAAK,GAAG,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QAC9C,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,OAAO,IAAI,CAAC,gBAAgB,CAAC,CAAC,uCAAuC;SACxE;QACD,MAAM,QAAQ,GAAG,SAAS,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,8BAA8B;QACnF,OAAO,SAAS,CAAC,SAAS,CAAC,KAAK,GAAG,EAAE,EAAE,QAAQ,CAAC,CAAC;IACrD,CAAC;;AAtCM,0BAAgB,GAAG,OAAO,CAAC;AADtC,8BAyCC","sourcesContent":["import {FileUtil} from '../common/file-util';\r\n/**\r\n * Created by martin on 10.03.2017.\r\n * Helper class to read XMl with a correct encoding.\r\n */\r\n\r\nexport class XmlReader {\r\n    static DEFAULT_ENCODING = 'UTF-8';\r\n\r\n    /**\r\n     * Read an xml-File.\r\n     * @param path Path to file\r\n     * @param encoding optional encoding of the xml.\r\n     * This is read from the file, but if you know it before, you can avoid reading the file twice.\r\n     * @return file content and encoding found in the file.\r\n     */\r\n    public static readXmlFileContent(path: string, encoding?: string): {content: string, encoding: string} {\r\n        if (!encoding) {\r\n            encoding = XmlReader.DEFAULT_ENCODING;\r\n        }\r\n        let content: string = FileUtil.read(path, encoding);\r\n        const foundEncoding = XmlReader.encodingFromXml(content);\r\n        if (foundEncoding !== encoding) {\r\n            // read again with the correct encoding\r\n            content = FileUtil.read(path, foundEncoding);\r\n        }\r\n        return {\r\n            content: content,\r\n            encoding: foundEncoding\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Read the encoding from the xml.\r\n     * xml File starts with .. encoding=\"..\"\r\n     * @param xmlString xmlString\r\n     * @return encoding\r\n     */\r\n    private static encodingFromXml(xmlString: string): string {\r\n        const index = xmlString.indexOf('encoding=\"');\r\n        if (index < 0) {\r\n            return this.DEFAULT_ENCODING; // default in xml if not explicitly set\r\n        }\r\n        const endIndex = xmlString.indexOf('\"', index + 10); // 10 = length of 'encoding=\"'\r\n        return xmlString.substring(index + 10, endIndex);\r\n    }\r\n\r\n}\r\n\r\n"]}