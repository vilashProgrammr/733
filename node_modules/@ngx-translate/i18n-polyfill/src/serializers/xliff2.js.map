{"version":3,"file":"xliff2.js","sourceRoot":"","sources":["../../../lib/src/serializers/xliff2.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport * as ml from \"../ast/ast\";\nimport * as i18n from \"../ast/i18n_ast\";\nimport * as xml from \"./xml_helper\";\nimport {Parser} from \"../ast/parser\";\nimport {getXmlTagDefinition} from \"../ast/xml_tags\";\nimport {I18nError} from \"../ast/parse_util\";\nimport {HtmlToXmlParser, I18nMessagesById, XmlMessagesById} from \"./serializer\";\nimport {decimalDigest} from \"./digest\";\n\nconst _VERSION = \"2.0\";\nconst _XMLNS = \"urn:oasis:names:tc:xliff:document:2.0\";\nconst _DEFAULT_SOURCE_LANG = \"en\";\nconst _PLACEHOLDER_TAG = \"ph\";\nconst _PLACEHOLDER_SPANNING_TAG = \"pc\";\nconst _XLIFF_TAG = \"xliff\";\nconst _SOURCE_TAG = \"source\";\nconst _TARGET_TAG = \"target\";\nconst _UNIT_TAG = \"unit\";\nconst _NOTES_TAG = \"notes\";\nconst _NOTE_TAG = \"note\";\nconst _SEGMENT_TAG = \"segment\";\nconst _FILE_TAG = \"file\";\n\n// http://docs.oasis-open.org/xliff/xliff-core/v2.0/os/xliff-core-v2.0-os.html\nexport function xliff2LoadToI18n(content: string): I18nMessagesById {\n  // xliff to xml nodes\n  const xliff2Parser = new Xliff2Parser();\n  const {msgIdToHtml, errors} = xliff2Parser.parse(content);\n\n  // xml nodes to i18n nodes\n  const i18nNodesByMsgId: {[msgId: string]: i18n.Node[]} = {};\n  const converter = new XmlToI18n();\n\n  Object.keys(msgIdToHtml).forEach(msgId => {\n    const {i18nNodes, errors: e} = converter.convert(msgIdToHtml[msgId]);\n    errors.push(...e);\n    i18nNodesByMsgId[msgId] = i18nNodes;\n  });\n\n  if (errors.length) {\n    throw new Error(`xliff2 parse errors:\\n${errors.join(\"\\n\")}`);\n  }\n\n  return i18nNodesByMsgId;\n}\n\n// used to merge translations when extracting\nexport function xliff2LoadToXml(content: string): XmlMessagesById {\n  const parser = new HtmlToXmlParser(_UNIT_TAG);\n  const {xmlMessagesById, errors} = parser.parse(content);\n\n  if (errors.length) {\n    throw new Error(`xliff2 parse errors:\\n${errors.join(\"\\n\")}`);\n  }\n\n  return xmlMessagesById;\n}\n\nexport function xliff2Write(messages: i18n.Message[], locale: string | null, existingNodes?: xml.Node[]): string {\n  const visitor = new WriteVisitor();\n  const units: xml.Node[] = existingNodes && existingNodes.length ? [new xml.CR(4), ...existingNodes] : [];\n\n  messages.forEach(message => {\n    const unit = new xml.Tag(_UNIT_TAG, {id: message.id});\n    const notes = new xml.Tag(_NOTES_TAG);\n\n    if (message.description || message.meaning) {\n      if (message.description) {\n        notes.children.push(\n          new xml.CR(8),\n          new xml.Tag(_NOTE_TAG, {category: \"description\"}, [new xml.Text(message.description)])\n        );\n      }\n\n      if (message.meaning) {\n        notes.children.push(\n          new xml.CR(8),\n          new xml.Tag(_NOTE_TAG, {category: \"meaning\"}, [new xml.Text(message.meaning)])\n        );\n      }\n    }\n\n    message.sources.forEach((source: i18n.MessageSpan) => {\n      notes.children.push(\n        new xml.CR(8),\n        new xml.Tag(_NOTE_TAG, {category: \"location\"}, [\n          new xml.Text(\n            `${source.filePath}:${source.startLine}${source.endLine !== source.startLine ? \",\" + source.endLine : \"\"}`\n          )\n        ])\n      );\n    });\n\n    notes.children.push(new xml.CR(6));\n    unit.children.push(new xml.CR(6), notes);\n\n    const segment = new xml.Tag(_SEGMENT_TAG);\n\n    segment.children.push(new xml.CR(8), new xml.Tag(_SOURCE_TAG, {}, visitor.serialize(message.nodes)), new xml.CR(6));\n\n    unit.children.push(new xml.CR(6), segment, new xml.CR(4));\n\n    units.push(new xml.CR(4), unit);\n  });\n\n  const file = new xml.Tag(_FILE_TAG, {original: \"ng.template\", id: \"ngi18n\"}, [...units, new xml.CR(2)]);\n\n  const xliff = new xml.Tag(_XLIFF_TAG, {version: _VERSION, xmlns: _XMLNS, srcLang: locale || _DEFAULT_SOURCE_LANG}, [\n    new xml.CR(2),\n    file,\n    new xml.CR()\n  ]);\n\n  return xml.serialize([new xml.Declaration({version: \"1.0\", encoding: \"UTF-8\"}), new xml.CR(), xliff, new xml.CR()]);\n}\n\nexport const xliff2Digest = decimalDigest;\n\n// Extract messages as xml nodes from the xliff file\nclass Xliff2Parser implements ml.Visitor {\n  private _unitMlString: string | null;\n  private _errors: I18nError[];\n  private _msgIdToHtml: {[msgId: string]: string};\n\n  parse(content: string) {\n    this._unitMlString = null;\n    this._msgIdToHtml = {};\n\n    const parser = new Parser(getXmlTagDefinition).parse(content, \"\", false);\n\n    this._errors = parser.errors;\n    ml.visitAll(this, parser.rootNodes, null);\n\n    return {\n      msgIdToHtml: this._msgIdToHtml,\n      errors: this._errors\n    };\n  }\n\n  visitElement(element: ml.Element, context: any): any {\n    switch (element.name) {\n      case _UNIT_TAG:\n        this._unitMlString = null;\n        const idAttr = element.attrs.find(attr => attr.name === \"id\");\n        if (!idAttr) {\n          this._addError(element, `<${_UNIT_TAG}> misses the \"id\" attribute`);\n        } else {\n          const id = idAttr.value;\n          if (this._msgIdToHtml.hasOwnProperty(id)) {\n            this._addError(element, `Duplicated translations for msg ${id}`);\n          } else {\n            ml.visitAll(this, element.children, null);\n            if (typeof this._unitMlString === \"string\") {\n              this._msgIdToHtml[id] = this._unitMlString;\n            } else {\n              this._addError(element, `Message ${id} misses a translation`);\n            }\n          }\n        }\n        break;\n\n      case _SOURCE_TAG:\n        // ignore source message\n        break;\n\n      case _TARGET_TAG:\n        const innerTextStart = element.startSourceSpan!.end.offset;\n        const innerTextEnd = element.endSourceSpan!.start.offset;\n        const content = element.startSourceSpan!.start.file.content;\n        const innerText = content.slice(innerTextStart, innerTextEnd);\n        this._unitMlString = innerText;\n        break;\n\n      case _XLIFF_TAG:\n        const versionAttr = element.attrs.find(attr => attr.name === \"version\");\n        if (versionAttr) {\n          const version = versionAttr.value;\n          if (version !== \"2.0\") {\n            this._addError(element, `The XLIFF file version ${version} is not compatible with XLIFF 2.0 serializer`);\n          } else {\n            ml.visitAll(this, element.children, null);\n          }\n        }\n        break;\n      default:\n        ml.visitAll(this, element.children, null);\n    }\n  }\n\n  visitAttribute(attribute: ml.Attribute, context: any): any {}\n\n  visitText(text: ml.Text, context: any): any {}\n\n  visitComment(comment: ml.Comment, context: any): any {}\n\n  visitExpansion(expansion: ml.Expansion, context: any): any {}\n\n  visitExpansionCase(expansionCase: ml.ExpansionCase, context: any): any {}\n\n  private _addError(node: ml.Node, message: string): void {\n    this._errors.push(new I18nError(node.sourceSpan, message));\n  }\n}\n\n// Convert ml nodes (xliff syntax) to i18n nodes\nclass XmlToI18n implements ml.Visitor {\n  private _errors: I18nError[];\n\n  convert(message: string) {\n    const xmlIcu = new Parser(getXmlTagDefinition).parse(message, \"\", true);\n    this._errors = xmlIcu.errors;\n\n    const i18nNodes =\n      this._errors.length > 0 || xmlIcu.rootNodes.length === 0 ? [] : [].concat(...ml.visitAll(this, xmlIcu.rootNodes));\n\n    return {\n      i18nNodes,\n      errors: this._errors\n    };\n  }\n\n  visitText(text: ml.Text, context: any) {\n    return new i18n.Text(text.value, text.sourceSpan);\n  }\n\n  visitElement(el: ml.Element, context: any): i18n.Node[] | null {\n    switch (el.name) {\n      case _PLACEHOLDER_TAG:\n        const nameAttr = el.attrs.find(attr => attr.name === \"equiv\");\n        if (nameAttr) {\n          return [new i18n.Placeholder(\"\", nameAttr.value, el.sourceSpan)];\n        }\n\n        this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equiv\" attribute`);\n        break;\n      case _PLACEHOLDER_SPANNING_TAG:\n        const startAttr = el.attrs.find(attr => attr.name === \"equivStart\");\n        const endAttr = el.attrs.find(attr => attr.name === \"equivEnd\");\n\n        if (!startAttr) {\n          this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equivStart\" attribute`);\n        } else if (!endAttr) {\n          this._addError(el, `<${_PLACEHOLDER_TAG}> misses the \"equivEnd\" attribute`);\n        } else {\n          const startId = startAttr.value;\n          const endId = endAttr.value;\n\n          const nodes: i18n.Node[] = [];\n\n          return nodes.concat(\n            new i18n.Placeholder(\"\", startId, el.sourceSpan),\n            ...el.children.map(node => node.visit(this, null)),\n            new i18n.Placeholder(\"\", endId, el.sourceSpan)\n          );\n        }\n        break;\n      default:\n        this._addError(el, `Unexpected tag`);\n    }\n\n    return null;\n  }\n\n  visitExpansion(icu: ml.Expansion, context: any) {\n    const caseMap: {[value: string]: i18n.Node} = {};\n\n    ml.visitAll(this, icu.cases).forEach((c: any) => {\n      caseMap[c.value] = new i18n.Container(c.nodes, icu.sourceSpan);\n    });\n\n    return new i18n.Icu(icu.switchValue, icu.type, caseMap, icu.sourceSpan);\n  }\n\n  visitExpansionCase(icuCase: ml.ExpansionCase, context: any): any {\n    return {\n      value: icuCase.value,\n      nodes: [].concat(...ml.visitAll(this, icuCase.expression))\n    };\n  }\n\n  visitComment(comment: ml.Comment, context: any) {}\n\n  visitAttribute(attribute: ml.Attribute, context: any) {}\n\n  private _addError(node: ml.Node, message: string): void {\n    this._errors.push(new I18nError(node.sourceSpan, message));\n  }\n}\n\nclass WriteVisitor implements i18n.Visitor {\n  private _nextPlaceholderId: number;\n\n  visitText(text: i18n.Text, context?: any): xml.Node[] {\n    return [new xml.Text(text.value)];\n  }\n\n  visitContainer(container: i18n.Container, context?: any): xml.Node[] {\n    const nodes: xml.Node[] = [];\n    container.children.forEach((node: i18n.Node) => nodes.push(...node.visit(this)));\n    return nodes;\n  }\n\n  visitIcu(icu: i18n.Icu, context?: any): xml.Node[] {\n    const nodes = [new xml.Text(`{${icu.expressionPlaceholder}, ${icu.type}, `)];\n\n    Object.keys(icu.cases).forEach((c: string) => {\n      nodes.push(new xml.Text(`${c} {`), ...icu.cases[c].visit(this), new xml.Text(`} `));\n    });\n\n    nodes.push(new xml.Text(`}`));\n\n    return nodes;\n  }\n\n  visitTagPlaceholder(ph: i18n.TagPlaceholder, context?: any): xml.Node[] {\n    const type = getTypeForTag(ph.tag);\n\n    if (ph.isVoid) {\n      const tagPh = new xml.Tag(_PLACEHOLDER_TAG, {\n        id: (this._nextPlaceholderId++).toString(),\n        equiv: ph.startName,\n        type,\n        disp: `<${ph.tag}/>`\n      });\n      return [tagPh];\n    }\n\n    const tagPc = new xml.Tag(_PLACEHOLDER_SPANNING_TAG, {\n      id: (this._nextPlaceholderId++).toString(),\n      equivStart: ph.startName,\n      equivEnd: ph.closeName,\n      type,\n      dispStart: `<${ph.tag}>`,\n      dispEnd: `</${ph.tag}>`\n    });\n    const nodes: xml.Node[] = [].concat(...ph.children.map(node => node.visit(this)));\n    if (nodes.length) {\n      nodes.forEach((node: xml.Node) => tagPc.children.push(node));\n    } else {\n      tagPc.children.push(new xml.Text(\"\"));\n    }\n\n    return [tagPc];\n  }\n\n  visitPlaceholder(ph: i18n.Placeholder, context?: any): xml.Node[] {\n    const idStr = (this._nextPlaceholderId++).toString();\n    return [\n      new xml.Tag(_PLACEHOLDER_TAG, {\n        id: idStr,\n        equiv: ph.name,\n        disp: `{{${ph.value}}}`\n      })\n    ];\n  }\n\n  visitIcuPlaceholder(ph: i18n.IcuPlaceholder, context?: any): xml.Node[] {\n    const cases = Object.keys(ph.value.cases)\n      .map((value: string) => value + \" {...}\")\n      .join(\" \");\n    const idStr = (this._nextPlaceholderId++).toString();\n    return [\n      new xml.Tag(_PLACEHOLDER_TAG, {\n        id: idStr,\n        equiv: ph.name,\n        disp: `{${ph.value.expression}, ${ph.value.type}, ${cases}}`\n      })\n    ];\n  }\n\n  serialize(nodes: i18n.Node[]): xml.Node[] {\n    this._nextPlaceholderId = 0;\n    return [].concat(...nodes.map(node => node.visit(this)));\n  }\n}\n\nfunction getTypeForTag(tag: string): string {\n  switch (tag.toLowerCase()) {\n    case \"br\":\n    case \"b\":\n    case \"i\":\n    case \"u\":\n      return \"fmt\";\n    case \"img\":\n      return \"image\";\n    case \"a\":\n      return \"link\";\n    default:\n      return \"other\";\n  }\n}\n"]}