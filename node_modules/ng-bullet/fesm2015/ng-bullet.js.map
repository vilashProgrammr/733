{"version":3,"file":"ng-bullet.js.map","sources":["ng://ng-bullet/src/testing.ts"],"sourcesContent":["import { Type } from '@angular/core';\r\nimport { ComponentFixture, getTestBed, TestBed } from '@angular/core/testing';\r\n\r\n/**\r\n * Reconfigures current test suit to prevent angular components re-compilation after every test run.\r\n * Forces angular test bed to re-create zone and all injectable services by directly\r\n * setting _instantiated variable to false after every test run.\r\n * Cleanups all the changes and reverts test bed configuration after suite has finished.\r\n *\r\n * @param configureAction an optional delegate which can be used to configure test bed for the current test suite\r\n * directly in the configureTestSuite call (you don't need extra BeforeAll in this case)\r\n */\r\nexport const configureTestSuite = (configureAction?: () => void) => {\r\n    const testBedApi: any = getTestBed();\r\n    const originReset = TestBed.resetTestingModule;\r\n\r\n    beforeAll(() => {\r\n        TestBed.resetTestingModule();\r\n        TestBed.resetTestingModule = () => TestBed;\r\n    });\r\n\r\n    if (configureAction) {\r\n        beforeAll((done: DoneFn) => (async () => {\r\n            configureAction();\r\n            await TestBed.compileComponents();\r\n        })().then(done).catch(done.fail));\r\n    }\r\n\r\n    afterEach(() => {\r\n        testBedApi._activeFixtures.forEach((fixture: ComponentFixture<any>) => fixture.destroy());\r\n        testBedApi._instantiated = false;\r\n    });\r\n\r\n    afterAll(() => {\r\n        TestBed.resetTestingModule = originReset;\r\n        TestBed.resetTestingModule();\r\n    });\r\n};\r\n\r\n/**\r\n * A wrapper class around ComponentFixture, which provides useful accessros:\r\n * component - to access component instance of current the fixture\r\n * element - to access underlying native element of the current component\r\n * detectChanges - to run change detections using current fixture\r\n * resolve - to resolve a type using current fixture's injector\r\n */\r\nexport class TestCtx<T> {\r\n    constructor(public fixture: ComponentFixture<T>) { }\r\n\r\n    public get component() { return this.fixture.componentInstance; }\r\n\r\n    public get element(): HTMLElement { return this.fixture.debugElement.nativeElement; }\r\n\r\n    public detectChanges() { this.fixture.detectChanges(); }\r\n\r\n    public resolve(component: Type<any>) { return this.fixture.debugElement.injector.get(component); }\r\n}\r\n\r\n/**\r\n * Creates TestCtx instance for the Angular Component which is not initialized yet (no ngOnInit called)\r\n * Use case: you can override Component's providers before hooks are called.\r\n *\r\n * @param component - type of component to create instance of\r\n * **/\r\nexport const createTestContext = <T>(component: Type<T>) => {\r\n    const fixture = TestBed.createComponent<T>(component);\r\n    const testCtx = new TestCtx<T>(fixture);\r\n    return testCtx;\r\n};\r\n\r\n/**Same as @function createTestContext, but waits till fixture becomes stable */\r\nexport const createStableTestContext = async <T>(component: Type<T>) => {\r\n    const testCtx = createTestContext(component);\r\n    testCtx.detectChanges();\r\n    await testCtx.fixture.whenStable();\r\n    testCtx.detectChanges();\r\n    return testCtx;\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAYA,uBAAa,kBAAkB,GAAG,CAAC,eAA4B;IAC3D,uBAAM,UAAU,GAAQ,UAAU,EAAE,CAAC;IACrC,uBAAM,WAAW,GAAG,OAAO,CAAC,kBAAkB,CAAC;IAE/C,SAAS,CAAC;QACN,OAAO,CAAC,kBAAkB,EAAE,CAAC;QAC7B,OAAO,CAAC,kBAAkB,GAAG,MAAM,OAAO,CAAC;KAC9C,CAAC,CAAC;IAEH,IAAI,eAAe,EAAE;QACjB,SAAS,CAAC,CAAC,IAAY,KAAK,CAAC;YACzB,eAAe,EAAE,CAAC;YAClB,MAAM,OAAO,CAAC,iBAAiB,EAAE,CAAC;UACrC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACrC;IAED,SAAS,CAAC;QACN,UAAU,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,OAA8B,KAAK,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;QAC1F,UAAU,CAAC,aAAa,GAAG,KAAK,CAAC;KACpC,CAAC,CAAC;IAEH,QAAQ,CAAC;QACL,OAAO,CAAC,kBAAkB,GAAG,WAAW,CAAC;QACzC,OAAO,CAAC,kBAAkB,EAAE,CAAC;KAChC,CAAC,CAAC;CACN,CAAC;;;;;;;;AASF;;;;IACI,YAAmB,OAA4B;QAA5B,YAAO,GAAP,OAAO,CAAqB;KAAK;;;;QAEzC,SAAS,KAAK,OAAO,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC;;;;QAEpD,OAAO,KAAkB,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,aAAa,CAAC;;;;IAE5E,aAAa,KAAK,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC;;;;;IAE/C,OAAO,CAAC,SAAoB,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;CACnG;;;;;;;;AAQD,uBAAa,iBAAiB,GAAG,CAAI,SAAkB;IACnD,uBAAM,OAAO,GAAG,OAAO,CAAC,eAAe,CAAI,SAAS,CAAC,CAAC;IACtD,uBAAM,OAAO,GAAG,IAAI,OAAO,CAAI,OAAO,CAAC,CAAC;IACxC,OAAO,OAAO,CAAC;CAClB,CAAC;;;;AAGF,uBAAa,uBAAuB,GAAG,CAAU,SAAkB;IAC/D,uBAAM,OAAO,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAC7C,OAAO,CAAC,aAAa,EAAE,CAAC;IACxB,MAAM,OAAO,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;IACnC,OAAO,CAAC,aAAa,EAAE,CAAC;IACxB,OAAO,OAAO,CAAC;EAClB;;;;;;;;;;;;;;"}
